<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Bio.Phylo._utils</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://biopython.org">Biopython</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="Bio-module.html">Package&nbsp;Bio</a> ::
        <a href="Bio.Phylo-module.html">Package&nbsp;Phylo</a> ::
        Module&nbsp;_utils
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="Bio.Phylo._utils-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module _utils</h1><p class="nomargin-top"><span class="codelink"><a href="Bio.Phylo._utils-pysrc.html">source&nbsp;code</a></span></p>
<p>Utilities for handling, displaying and exporting Phylo trees.</p>
<p>Third-party libraries are loaded when the corresponding function is called.</p>

<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Functions</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Functions"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Bio.Phylo._utils-module.html#to_networkx" class="summary-sig-name">to_networkx</a>(<span class="summary-sig-arg">tree</span>)</span><br />
      Convert a Tree object to a networkx graph.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="Bio.Phylo._utils-pysrc.html#to_networkx">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Bio.Phylo._utils-module.html#draw_graphviz" class="summary-sig-name">draw_graphviz</a>(<span class="summary-sig-arg">tree</span>,
        <span class="summary-sig-arg">label_func</span>=<span class="summary-sig-default">&lt;type 'str'&gt;</span>,
        <span class="summary-sig-arg">prog</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">twopi</code><code class="variable-quote">'</code></span>,
        <span class="summary-sig-arg">args</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string"></code><code class="variable-quote">'</code></span>,
        <span class="summary-sig-arg">node_color</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">#c0deff</code><code class="variable-quote">'</code></span>,
        <span class="summary-sig-arg">**kwargs</span>)</span><br />
      Display a tree or clade as a graph, using the graphviz engine.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="Bio.Phylo._utils-pysrc.html#draw_graphviz">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Bio.Phylo._utils-module.html#draw_ascii" class="summary-sig-name">draw_ascii</a>(<span class="summary-sig-arg">tree</span>,
        <span class="summary-sig-arg">file</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">column_width</span>=<span class="summary-sig-default">80</span>)</span><br />
      Draw an ascii-art phylogram of the given tree.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="Bio.Phylo._utils-pysrc.html#draw_ascii">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Bio.Phylo._utils-module.html#draw" class="summary-sig-name">draw</a>(<span class="summary-sig-arg">tree</span>,
        <span class="summary-sig-arg">label_func</span>=<span class="summary-sig-default">&lt;type 'str'&gt;</span>,
        <span class="summary-sig-arg">do_show</span>=<span class="summary-sig-default">True</span>,
        <span class="summary-sig-arg">show_confidence</span>=<span class="summary-sig-default">True</span>,
        <span class="summary-sig-arg">axes</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">branch_labels</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">label_colors</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">*args</span>,
        <span class="summary-sig-arg">**kwargs</span>)</span><br />
      Plot the given tree using matplotlib (or pylab).</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="Bio.Phylo._utils-pysrc.html#draw">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== VARIABLES ==================== -->
<a name="section-Variables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Variables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="__package__"></a><span class="summary-name">__package__</span> = <code title="'Bio.Phylo'"><code class="variable-quote">'</code><code class="variable-string">Bio.Phylo</code><code class="variable-quote">'</code></code>
    </td>
  </tr>
</table>
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Function Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-FunctionDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="to_networkx"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">to_networkx</span>(<span class="sig-arg">tree</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="Bio.Phylo._utils-pysrc.html#to_networkx">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Convert a Tree object to a networkx graph.</p>
<p>The result is useful for graph-oriented analysis, and also interactive
plotting with pylab, matplotlib or pygraphviz, though the resulting diagram
is usually not ideal for displaying a phylogeny.</p>
<p>Requires NetworkX version 0.99 or later.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="draw_graphviz"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">draw_graphviz</span>(<span class="sig-arg">tree</span>,
        <span class="sig-arg">label_func</span>=<span class="sig-default">&lt;type 'str'&gt;</span>,
        <span class="sig-arg">prog</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">twopi</code><code class="variable-quote">'</code></span>,
        <span class="sig-arg">args</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string"></code><code class="variable-quote">'</code></span>,
        <span class="sig-arg">node_color</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">#c0deff</code><code class="variable-quote">'</code></span>,
        <span class="sig-arg">**kwargs</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="Bio.Phylo._utils-pysrc.html#draw_graphviz">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Display a tree or clade as a graph, using the graphviz engine.</p>
<p>Requires NetworkX, matplotlib, Graphviz and either PyGraphviz or pydot.</p>
<p>The third and fourth parameters apply to Graphviz, and the remaining
arbitrary keyword arguments are passed directly to networkx.draw(), which
in turn mostly wraps matplotlib/pylab.  See the documentation for Graphviz
and networkx for detailed explanations.</p>
<p>The NetworkX/matplotlib parameters are described in the docstrings for
networkx.draw() and pylab.scatter(), but the most reasonable options to try
are: <em>alpha, node_color, node_size, node_shape, edge_color, style,
font_size, font_color, font_weight, font_family</em></p>
<div class="rst-section" id="rst-examples">
<h1 class="heading">Examples</h1>
<p>Load a PhyloXML format tree, and draw a PNG using GraphViz:</p>
<pre class="rst-literal-block">
import pylab
from Bio import Phylo
tree = Phylo.read('PhyloXML/apaf.xml', 'phyloxml')
Phylo.draw_graphviz(tree)
pylab.show()
pylab.savefig('apaf.png')
</pre>
</div>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><p><strong class="pname"><code>label_func</code></strong> (callable) - A function to extract a label from a node. By default this is str(),
but you can use a different function to select another string
associated with each node. If this function returns None for a node,
no label will be shown for that node.</p>
<p>The label will also be silently skipped if the throws an exception
related to ordinary attribute access (LookupError, AttributeError,
ValueError); all other exception types will still be raised. This
means you can use a lambda expression that simply attempts to look
up the desired value without checking if the intermediate attributes
are available:</p>
<pre class="rst-literal-block">
from Bio import Phylo, AlignIO
from Bio.Phylo.TreeConstruction import DistanceCalculator, DistanceTreeConstructor
constructor = DistanceTreeConstructor()
aln = AlignIO.read(open('TreeConstruction/msa.phy'), 'phylip')
calculator = DistanceCalculator('identity')
dm = calculator.get_distance(aln)
tree = constructor.upgma(dm)
Phylo.draw_graphviz(tree, lambda n: n.taxonomies[0].code)
</pre></li>
        <li><strong class="pname"><code>prog</code></strong> (string) - The Graphviz program to use when rendering the graph. 'twopi'
behaves the best for large graphs, reliably avoiding crossing edges,
but for moderate graphs 'neato' looks a bit nicer.  For small
directed graphs, 'dot' may produce a normal-looking cladogram, but
will cross and distort edges in larger graphs. (The programs 'circo'
and 'fdp' are not recommended.)</li>
        <li><strong class="pname"><code>args</code></strong> (string) - Options passed to the external graphviz program.  Normally not
needed, but offered here for completeness.</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="draw_ascii"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">draw_ascii</span>(<span class="sig-arg">tree</span>,
        <span class="sig-arg">file</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">column_width</span>=<span class="sig-default">80</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="Bio.Phylo._utils-pysrc.html#draw_ascii">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Draw an ascii-art phylogram of the given tree.</p>
<p>The printed result looks like:</p>
<pre class="rst-literal-block">
                                _________ Orange
                 ______________|
                |              |______________ Tangerine
  ______________|
 |              |          _________________________ Grapefruit
_|              |_________|
 |                        |______________ Pummelo
 |
 |__________________________________ Apple
</pre>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>file</code></strong> (file-like object) - File handle opened for writing the output drawing. (Default:
standard output)</li>
        <li><strong class="pname"><code>column_width</code></strong> (int) - Total number of text columns used by the drawing.</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="draw"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">draw</span>(<span class="sig-arg">tree</span>,
        <span class="sig-arg">label_func</span>=<span class="sig-default">&lt;type 'str'&gt;</span>,
        <span class="sig-arg">do_show</span>=<span class="sig-default">True</span>,
        <span class="sig-arg">show_confidence</span>=<span class="sig-default">True</span>,
        <span class="sig-arg">axes</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">branch_labels</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">label_colors</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">*args</span>,
        <span class="sig-arg">**kwargs</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="Bio.Phylo._utils-pysrc.html#draw">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Plot the given tree using matplotlib (or pylab).</p>
<p>The graphic is a rooted tree, drawn with roughly the same algorithm as
draw_ascii.</p>
<p>Additional keyword arguments passed into this function are used as pyplot
options. The input format should be in the form of:
pyplot_option_name=(tuple), pyplot_option_name=(tuple, dict), or
pyplot_option_name=(dict).</p>
<p>Example using the pyplot options 'axhspan' and 'axvline':</p>
<pre class="rst-literal-block">
from Bio import Phylo, AlignIO
from Bio.Phylo.TreeConstruction import DistanceCalculator, DistanceTreeConstructor
constructor = DistanceTreeConstructor()
aln = AlignIO.read(open('TreeConstruction/msa.phy'), 'phylip')
calculator = DistanceCalculator('identity')
dm = calculator.get_distance(aln)
tree = constructor.upgma(dm)
Phylo.draw(tree, axhspan=((0.25, 7.75), {'facecolor':'0.5'}),
... axvline={'x':0, 'ymin':0, 'ymax':1})
</pre>
<p>Visual aspects of the plot can also be modified using pyplot's own functions
and objects (via pylab or matplotlib). In particular, the pyplot.rcParams
object can be used to scale the font size (rcParams[&quot;font.size&quot;]) and line
width (rcParams[&quot;lines.linewidth&quot;]).</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>label_func</code></strong> (callable) - A function to extract a label from a node. By default this is str(),
but you can use a different function to select another string
associated with each node. If this function returns None for a node,
no label will be shown for that node.</li>
        <li><strong class="pname"><code>do_show</code></strong> (bool) - Whether to show() the plot automatically.</li>
        <li><strong class="pname"><code>show_confidence</code></strong> (bool) - Whether to display confidence values, if present on the tree.</li>
        <li><strong class="pname"><code>axes</code></strong> (matplotlib/pylab axes) - If a valid matplotlib.axes.Axes instance, the phylogram is plotted
in that Axes. By default (None), a new figure is created.</li>
        <li><strong class="pname"><code>branch_labels</code></strong> (dict or callable) - A mapping of each clade to the label that will be shown along the
branch leading to it. By default this is the confidence value(s) of
the clade, taken from the <tt class="rst-docutils literal">confidence</tt> attribute, and can be
easily toggled off with this function's <tt class="rst-docutils literal">show_confidence</tt> option.
But if you would like to alter the formatting of confidence values,
or label the branches with something other than confidence, then use
this option.</li>
        <li><strong class="pname"><code>label_colors</code></strong> (dict or callable) - A function or a dictionary specifying the color of the tip label.
If the tip label can't be found in the dict or label_colors is
None, the label will be shown in black.</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://biopython.org">Biopython</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Wed Nov  6 13:32:23 2019
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
