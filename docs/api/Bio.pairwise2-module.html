<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Bio.pairwise2</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://biopython.org">Biopython</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="Bio-module.html">Package&nbsp;Bio</a> ::
        Module&nbsp;pairwise2
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="Bio.pairwise2-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module pairwise2</h1><p class="nomargin-top"><span class="codelink"><a href="Bio.pairwise2-pysrc.html">source&nbsp;code</a></span></p>
<p>Pairwise sequence alignment using a dynamic programming algorithm.</p>
<p>This provides functions to get global and local alignments between two
sequences. A global alignment finds the best concordance between all
characters in two sequences. A local alignment finds just the
subsequences that align the best. Local alignments must have a positive
score to be reported and they will not be extended for 'zero counting'
matches. This means a local alignment will always start and end with
a positive counting match.</p>
<p>When doing alignments, you can specify the match score and gap
penalties.  The match score indicates the compatibility between an
alignment of two characters in the sequences. Highly compatible
characters should be given positive scores, and incompatible ones
should be given negative scores or 0.  The gap penalties should be
negative.</p>
<p>The names of the alignment functions in this module follow the
convention
&lt;alignment type&gt;XX
where &lt;alignment type&gt; is either &quot;global&quot; or &quot;local&quot; and XX is a 2
character code indicating the parameters it takes.  The first
character indicates the parameters for matches (and mismatches), and
the second indicates the parameters for gap penalties.</p>
<p>The match parameters are:</p>
<pre class="rst-literal-block">
CODE  DESCRIPTION
x     No parameters. Identical characters have score of 1, otherwise 0.
m     A match score is the score of identical chars, otherwise mismatch
      score.
d     A dictionary returns the score of any pair of characters.
c     A callback function returns scores.
</pre>
<p>The gap penalty parameters are:</p>
<pre class="rst-literal-block">
CODE  DESCRIPTION
x     No gap penalties.
s     Same open and extend gap penalties for both sequences.
d     The sequences have different open and extend gap penalties.
c     A callback function returns the gap penalties.
</pre>
<p>All the different alignment functions are contained in an object
<tt class="rst-docutils literal">align</tt>. For example:</p>
<blockquote>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">from</span> Bio <span class="py-keyword">import</span> pairwise2
<span class="py-prompt">&gt;&gt;&gt; </span>alignments = pairwise2.align.globalxx(<span class="py-string">&quot;ACCGT&quot;</span>, <span class="py-string">&quot;ACG&quot;</span>)</pre>
</blockquote>
<p>will return a list of the alignments between the two strings. For a nice
printout, use the <tt class="rst-docutils literal">format_alignment</tt> method of the module:</p>
<blockquote>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">from</span> Bio.pairwise2 <span class="py-keyword">import</span> format_alignment
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">print</span>(format_alignment(*alignments[0]))
<span class="py-output">ACCGT</span>
<span class="py-output">| ||</span>
<span class="py-output">A-CG-</span>
<span class="py-output">  Score=3</span>
<span class="py-output">&lt;BLANKLINE&gt;</span></pre>
</blockquote>
<p>All alignment functions have the following arguments:</p>
<ul class="rst-simple">
<li>Two sequences: strings, Biopython sequence objects or lists.
Lists are useful for supplying sequences which contain residues that are
encoded by more than one letter.</li>
<li><tt class="rst-docutils literal">penalize_extend_when_opening</tt>: boolean (default: False).
Whether to count an extension penalty when opening a gap. If false, a gap of
1 is only penalized an &quot;open&quot; penalty, otherwise it is penalized
&quot;open+extend&quot;.</li>
<li><tt class="rst-docutils literal">penalize_end_gaps</tt>: boolean.
Whether to count the gaps at the ends of an alignment. By default, they are
counted for global alignments but not for local ones. Setting
<tt class="rst-docutils literal">penalize_end_gaps</tt> to (boolean, boolean) allows you to specify for the
two sequences separately whether gaps at the end of the alignment should be
counted.</li>
<li><tt class="rst-docutils literal">gap_char</tt>: string (default: <tt class="rst-docutils literal"><span class="pre">'-'</span></tt>).
Which character to use as a gap character in the alignment returned. If your
input sequences are lists, you must change this to <tt class="rst-docutils literal"><span class="pre">['-']</span></tt>.</li>
<li><tt class="rst-docutils literal">force_generic</tt>: boolean (default: False).
Always use the generic, non-cached, dynamic programming function (slow!).
For debugging.</li>
<li><tt class="rst-docutils literal">score_only</tt>: boolean (default: False).
Only get the best score, don't recover any alignments. The return value of
the function is the score. Faster and uses less memory.</li>
<li><tt class="rst-docutils literal">one_alignment_only</tt>: boolean (default: False).
Only recover one alignment.</li>
</ul>
<p>The other parameters of the alignment function depend on the function called.
Some examples:</p>
<ul>
<li><p class="rst-first">Find the best global alignment between the two sequences. Identical
characters are given 1 point. No points are deducted for mismatches or gaps.</p>
<blockquote>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">for</span> a <span class="py-keyword">in</span> pairwise2.align.globalxx(<span class="py-string">&quot;ACCGT&quot;</span>, <span class="py-string">&quot;ACG&quot;</span>):
<span class="py-more">... </span>    <span class="py-keyword">print</span>(format_alignment(*a))
<span class="py-output">ACCGT</span>
<span class="py-output">| ||</span>
<span class="py-output">A-CG-</span>
<span class="py-output">  Score=3</span>
<span class="py-output">&lt;BLANKLINE&gt;</span>
<span class="py-output">ACCGT</span>
<span class="py-output">|| |</span>
<span class="py-output">AC-G-</span>
<span class="py-output">  Score=3</span>
<span class="py-output">&lt;BLANKLINE&gt;</span></pre>
</blockquote>
</li>
<li><p class="rst-first">Same thing as before, but with a local alignment. Note that
<tt class="rst-docutils literal">format_alignment</tt> will only show the aligned parts of the sequences,
together with the starting positions.</p>
<blockquote>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">for</span> a <span class="py-keyword">in</span> pairwise2.align.localxx(<span class="py-string">&quot;ACCGT&quot;</span>, <span class="py-string">&quot;ACG&quot;</span>):
<span class="py-more">... </span>    <span class="py-keyword">print</span>(format_alignment(*a))
<span class="py-output">1 ACCG</span>
<span class="py-output">  | ||</span>
<span class="py-output">1 A-CG</span>
<span class="py-output">  Score=3</span>
<span class="py-output">&lt;BLANKLINE&gt;</span>
<span class="py-output">1 ACCG</span>
<span class="py-output">  || |</span>
<span class="py-output">1 AC-G</span>
<span class="py-output">  Score=3</span>
<span class="py-output">&lt;BLANKLINE&gt;</span></pre>
</blockquote>
<p>To restore the 'historic' behaviour of <tt class="rst-docutils literal">format_alignemt</tt>, i.e., showing
also the un-aligned parts of both sequences, use the new keyword parameter
<tt class="rst-docutils literal">full_sequences</tt>:</p>
<blockquote>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">for</span> a <span class="py-keyword">in</span> pairwise2.align.localxx(<span class="py-string">&quot;ACCGT&quot;</span>, <span class="py-string">&quot;ACG&quot;</span>):
<span class="py-more">... </span>    <span class="py-keyword">print</span>(format_alignment(*a, full_sequences=True))
<span class="py-output">ACCGT</span>
<span class="py-output">| ||</span>
<span class="py-output">A-CG-</span>
<span class="py-output">  Score=3</span>
<span class="py-output">&lt;BLANKLINE&gt;</span>
<span class="py-output">ACCGT</span>
<span class="py-output">|| |</span>
<span class="py-output">AC-G-</span>
<span class="py-output">  Score=3</span>
<span class="py-output">&lt;BLANKLINE&gt;</span></pre>
</blockquote>
</li>
<li><p class="rst-first">Do a global alignment. Identical characters are given 2 points, 1 point is
deducted for each non-identical character. Don't penalize gaps.</p>
<blockquote>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">for</span> a <span class="py-keyword">in</span> pairwise2.align.globalmx(<span class="py-string">&quot;ACCGT&quot;</span>, <span class="py-string">&quot;ACG&quot;</span>, 2, -1):
<span class="py-more">... </span>    <span class="py-keyword">print</span>(format_alignment(*a))
<span class="py-output">ACCGT</span>
<span class="py-output">| ||</span>
<span class="py-output">A-CG-</span>
<span class="py-output">  Score=6</span>
<span class="py-output">&lt;BLANKLINE&gt;</span>
<span class="py-output">ACCGT</span>
<span class="py-output">|| |</span>
<span class="py-output">AC-G-</span>
<span class="py-output">  Score=6</span>
<span class="py-output">&lt;BLANKLINE&gt;</span></pre>
</blockquote>
</li>
<li><p class="rst-first">Same as above, except now 0.5 points are deducted when opening a gap, and
0.1 points are deducted when extending it.</p>
<blockquote>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">for</span> a <span class="py-keyword">in</span> pairwise2.align.globalms(<span class="py-string">&quot;ACCGT&quot;</span>, <span class="py-string">&quot;ACG&quot;</span>, 2, -1, -.5, -.1):
<span class="py-more">... </span>    <span class="py-keyword">print</span>(format_alignment(*a))
<span class="py-output">ACCGT</span>
<span class="py-output">| ||</span>
<span class="py-output">A-CG-</span>
<span class="py-output">  Score=5</span>
<span class="py-output">&lt;BLANKLINE&gt;</span>
<span class="py-output">ACCGT</span>
<span class="py-output">|| |</span>
<span class="py-output">AC-G-</span>
<span class="py-output">  Score=5</span>
<span class="py-output">&lt;BLANKLINE&gt;</span></pre>
</blockquote>
</li>
<li><p class="rst-first">Depending on the penalties, a gap in one sequence may be followed by a gap in
the other sequence.If you don't like this behaviour, increase the gap-open
penalty:</p>
<blockquote>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">for</span> a <span class="py-keyword">in</span> pairwise2.align.globalms(<span class="py-string">&quot;A&quot;</span>, <span class="py-string">&quot;T&quot;</span>, 5, -4, -1, -.1):
<span class="py-more">... </span>    <span class="py-keyword">print</span>(format_alignment(*a))
<span class="py-output">A-</span>
<span class="py-output">&lt;BLANKLINE&gt;</span>
<span class="py-output">-T</span>
<span class="py-output">  Score=-2</span>
<span class="py-output">&lt;BLANKLINE&gt;</span>
<span class="py-output"></span><span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">for</span> a <span class="py-keyword">in</span> pairwise2.align.globalms(<span class="py-string">&quot;A&quot;</span>, <span class="py-string">&quot;T&quot;</span>, 5, -4, -3, -.1):
<span class="py-more">... </span>    <span class="py-keyword">print</span>(format_alignment(*a))
<span class="py-output">A</span>
<span class="py-output">.</span>
<span class="py-output">T</span>
<span class="py-output">  Score=-4</span>
<span class="py-output">&lt;BLANKLINE&gt;</span></pre>
</blockquote>
</li>
<li><p class="rst-first">The alignment function can also use known matrices already included in
Biopython (<tt class="rst-docutils literal">MatrixInfo</tt> from <tt class="rst-docutils literal">Bio.SubsMat</tt>):</p>
<blockquote>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">from</span> Bio.SubsMat <span class="py-keyword">import</span> MatrixInfo <span class="py-keyword">as</span> matlist
<span class="py-prompt">&gt;&gt;&gt; </span>matrix = matlist.blosum62
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">for</span> a <span class="py-keyword">in</span> pairwise2.align.globaldx(<span class="py-string">&quot;KEVLA&quot;</span>, <span class="py-string">&quot;EVL&quot;</span>, matrix):
<span class="py-more">... </span>    <span class="py-keyword">print</span>(format_alignment(*a))
<span class="py-output">KEVLA</span>
<span class="py-output"> |||</span>
<span class="py-output">-EVL-</span>
<span class="py-output">  Score=13</span>
<span class="py-output">&lt;BLANKLINE&gt;</span></pre>
</blockquote>
</li>
<li><p class="rst-first">With the parameter <tt class="rst-docutils literal">c</tt> you can define your own match- and gap functions.
E.g. to define an affine logarithmic gap function and using it:</p>
<blockquote>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">from</span> math <span class="py-keyword">import</span> log
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">def</span> <span class="py-defname">gap_function</span>(x, y):  <span class="py-comment"># x is gap position in seq, y is gap length</span>
<span class="py-more">... </span>    <span class="py-keyword">if</span> y == 0:  <span class="py-comment"># No gap</span>
<span class="py-more">... </span>        return 0
<span class="py-more">... </span>    <span class="py-keyword">elif</span> y == 1:  <span class="py-comment"># Gap open penalty</span>
<span class="py-more">... </span>        return -2
<span class="py-more">... </span>    return - (2 + y/4.0 + log(y)/2.0)
<span class="py-more">...</span>
<span class="py-prompt">&gt;&gt;&gt; </span>alignment = pairwise2.align.globalmc(<span class="py-string">&quot;ACCCCCGT&quot;</span>, <span class="py-string">&quot;ACG&quot;</span>, 5, -4,
<span class="py-more">... </span>                                     gap_function, gap_function)</pre>
</blockquote>
<p>You can define different gap functions for each sequence.
Self-defined match functions must take the two residues to be compared and
return a score.</p>
</li>
</ul>
<p>To see a description of the parameters for a function, please look at
the docstring for the function via the help function, e.g.
type <tt class="rst-docutils literal">help(pairwise2.align.localds)</tt> at the Python prompt.</p>

<!-- ==================== CLASSES ==================== -->
<a name="section-Classes"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Classes</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Classes"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="Bio.pairwise2.identity_match-class.html" class="summary-name">identity_match</a><br />
      Create a match function for use in an alignment.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="Bio.pairwise2.dictionary_match-class.html" class="summary-name">dictionary_match</a><br />
      Create a match function for use in an alignment.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="Bio.pairwise2.affine_penalty-class.html" class="summary-name">affine_penalty</a><br />
      Create a gap function for use in an alignment.
    </td>
  </tr>
</table>
<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Functions</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Functions"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Bio.pairwise2-module.html#_align" class="summary-sig-name" onclick="show_private();">_align</a>(<span class="summary-sig-arg">sequenceA</span>,
        <span class="summary-sig-arg">sequenceB</span>,
        <span class="summary-sig-arg">match_fn</span>,
        <span class="summary-sig-arg">gap_A_fn</span>,
        <span class="summary-sig-arg">gap_B_fn</span>,
        <span class="summary-sig-arg">penalize_extend_when_opening</span>,
        <span class="summary-sig-arg">penalize_end_gaps</span>,
        <span class="summary-sig-arg">align_globally</span>,
        <span class="summary-sig-arg">gap_char</span>,
        <span class="summary-sig-arg">force_generic</span>,
        <span class="summary-sig-arg">score_only</span>,
        <span class="summary-sig-arg">one_alignment_only</span>)</span><br />
      Return optimal alignments between two sequences (PRIVATE).</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="Bio.pairwise2-pysrc.html#_align">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Bio.pairwise2-module.html#_make_score_matrix_generic" class="summary-sig-name" onclick="show_private();">_make_score_matrix_generic</a>(<span class="summary-sig-arg">sequenceA</span>,
        <span class="summary-sig-arg">sequenceB</span>,
        <span class="summary-sig-arg">match_fn</span>,
        <span class="summary-sig-arg">gap_A_fn</span>,
        <span class="summary-sig-arg">gap_B_fn</span>,
        <span class="summary-sig-arg">penalize_end_gaps</span>,
        <span class="summary-sig-arg">align_globally</span>,
        <span class="summary-sig-arg">score_only</span>)</span><br />
      Generate a score and traceback matrix (PRIVATE).</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="Bio.pairwise2-pysrc.html#_make_score_matrix_generic">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Bio.pairwise2-module.html#_recover_alignments" class="summary-sig-name" onclick="show_private();">_recover_alignments</a>(<span class="summary-sig-arg">sequenceA</span>,
        <span class="summary-sig-arg">sequenceB</span>,
        <span class="summary-sig-arg">starts</span>,
        <span class="summary-sig-arg">best_score</span>,
        <span class="summary-sig-arg">score_matrix</span>,
        <span class="summary-sig-arg">trace_matrix</span>,
        <span class="summary-sig-arg">align_globally</span>,
        <span class="summary-sig-arg">gap_char</span>,
        <span class="summary-sig-arg">one_alignment_only</span>,
        <span class="summary-sig-arg">gap_A_fn</span>,
        <span class="summary-sig-arg">gap_B_fn</span>,
        <span class="summary-sig-arg">reverse</span>=<span class="summary-sig-default">False</span>)</span><br />
      Do the backtracing and return a list of alignments (PRIVATE).</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="Bio.pairwise2-pysrc.html#_recover_alignments">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Bio.pairwise2-module.html#_find_start" class="summary-sig-name" onclick="show_private();">_find_start</a>(<span class="summary-sig-arg">score_matrix</span>,
        <span class="summary-sig-arg">best_score</span>,
        <span class="summary-sig-arg">align_globally</span>)</span><br />
      Return a list of starting points (score, (row, col)) (PRIVATE).</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="Bio.pairwise2-pysrc.html#_find_start">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_reverse_matrices"></a><span class="summary-sig-name">_reverse_matrices</span>(<span class="summary-sig-arg">score_matrix</span>,
        <span class="summary-sig-arg">trace_matrix</span>)</span><br />
      Reverse score and trace matrices (PRIVATE).</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="Bio.pairwise2-pysrc.html#_reverse_matrices">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Bio.pairwise2-module.html#_clean_alignments" class="summary-sig-name" onclick="show_private();">_clean_alignments</a>(<span class="summary-sig-arg">alignments</span>)</span><br />
      Take a list of alignments and return a cleaned version (PRIVATE).</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="Bio.pairwise2-pysrc.html#_clean_alignments">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_finish_backtrace"></a><span class="summary-sig-name">_finish_backtrace</span>(<span class="summary-sig-arg">sequenceA</span>,
        <span class="summary-sig-arg">sequenceB</span>,
        <span class="summary-sig-arg">ali_seqA</span>,
        <span class="summary-sig-arg">ali_seqB</span>,
        <span class="summary-sig-arg">row</span>,
        <span class="summary-sig-arg">col</span>,
        <span class="summary-sig-arg">gap_char</span>)</span><br />
      Add remaining sequences and fill with gaps if necessary (PRIVATE).</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="Bio.pairwise2-pysrc.html#_finish_backtrace">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_find_gap_open"></a><span class="summary-sig-name">_find_gap_open</span>(<span class="summary-sig-arg">sequenceA</span>,
        <span class="summary-sig-arg">sequenceB</span>,
        <span class="summary-sig-arg">ali_seqA</span>,
        <span class="summary-sig-arg">ali_seqB</span>,
        <span class="summary-sig-arg">end</span>,
        <span class="summary-sig-arg">row</span>,
        <span class="summary-sig-arg">col</span>,
        <span class="summary-sig-arg">col_gap</span>,
        <span class="summary-sig-arg">gap_char</span>,
        <span class="summary-sig-arg">score_matrix</span>,
        <span class="summary-sig-arg">trace_matrix</span>,
        <span class="summary-sig-arg">in_process</span>,
        <span class="summary-sig-arg">gap_fn</span>,
        <span class="summary-sig-arg">target</span>,
        <span class="summary-sig-arg">index</span>,
        <span class="summary-sig-arg">direction</span>,
        <span class="summary-sig-arg">best_score</span>,
        <span class="summary-sig-arg">align_globally</span>)</span><br />
      Find the starting point(s) of the extended gap (PRIVATE).</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="Bio.pairwise2-pysrc.html#_find_gap_open">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="calc_affine_penalty"></a><span class="summary-sig-name">calc_affine_penalty</span>(<span class="summary-sig-arg">length</span>,
        <span class="summary-sig-arg">open</span>,
        <span class="summary-sig-arg">extend</span>,
        <span class="summary-sig-arg">penalize_extend_when_opening</span>)</span><br />
      Calculate a penality score for the gap function.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="Bio.pairwise2-pysrc.html#calc_affine_penalty">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="print_matrix"></a><span class="summary-sig-name">print_matrix</span>(<span class="summary-sig-arg">matrix</span>)</span><br />
      Print out a matrix for debugging purposes.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="Bio.pairwise2-pysrc.html#print_matrix">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Bio.pairwise2-module.html#format_alignment" class="summary-sig-name">format_alignment</a>(<span class="summary-sig-arg">align1</span>,
        <span class="summary-sig-arg">align2</span>,
        <span class="summary-sig-arg">score</span>,
        <span class="summary-sig-arg">begin</span>,
        <span class="summary-sig-arg">end</span>,
        <span class="summary-sig-arg">full_sequences</span>=<span class="summary-sig-default">False</span>)</span><br />
      Format the alignment prettily into a string.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="Bio.pairwise2-pysrc.html#format_alignment">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Bio.pairwise2-module.html#_python_make_score_matrix_fast" class="summary-sig-name" onclick="show_private();">_python_make_score_matrix_fast</a>(<span class="summary-sig-arg">sequenceA</span>,
        <span class="summary-sig-arg">sequenceB</span>,
        <span class="summary-sig-arg">match_fn</span>,
        <span class="summary-sig-arg">open_A</span>,
        <span class="summary-sig-arg">extend_A</span>,
        <span class="summary-sig-arg">open_B</span>,
        <span class="summary-sig-arg">extend_B</span>,
        <span class="summary-sig-arg">penalize_extend_when_opening</span>,
        <span class="summary-sig-arg">penalize_end_gaps</span>,
        <span class="summary-sig-arg">align_globally</span>,
        <span class="summary-sig-arg">score_only</span>)</span><br />
      Generate a score and traceback matrix according to Gotoh (PRIVATE).</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="Bio.pairwise2-pysrc.html#_python_make_score_matrix_fast">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_python_rint"></a><span class="summary-sig-name">_python_rint</span>(<span class="summary-sig-arg">x</span>,
        <span class="summary-sig-arg">precision</span>=<span class="summary-sig-default">1000</span>)</span><br />
      Print number with declared precision.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="Bio.pairwise2-pysrc.html#_python_rint">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== VARIABLES ==================== -->
<a name="section-Variables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Variables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="MAX_ALIGNMENTS"></a><span class="summary-name">MAX_ALIGNMENTS</span> = <code title="1000">1000</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="align"></a><span class="summary-name">align</span> = <code title="align()">align()</code>
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="_PRECISION"></a><span class="summary-name">_PRECISION</span> = <code title="1000">1000</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="__package__"></a><span class="summary-name">__package__</span> = <code title="'Bio'"><code class="variable-quote">'</code><code class="variable-string">Bio</code><code class="variable-quote">'</code></code>
    </td>
  </tr>
</table>
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Function Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-FunctionDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="_align"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_align</span>(<span class="sig-arg">sequenceA</span>,
        <span class="sig-arg">sequenceB</span>,
        <span class="sig-arg">match_fn</span>,
        <span class="sig-arg">gap_A_fn</span>,
        <span class="sig-arg">gap_B_fn</span>,
        <span class="sig-arg">penalize_extend_when_opening</span>,
        <span class="sig-arg">penalize_end_gaps</span>,
        <span class="sig-arg">align_globally</span>,
        <span class="sig-arg">gap_char</span>,
        <span class="sig-arg">force_generic</span>,
        <span class="sig-arg">score_only</span>,
        <span class="sig-arg">one_alignment_only</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="Bio.pairwise2-pysrc.html#_align">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Return optimal alignments between two sequences (PRIVATE).</p>
<p>This method either returns a list of optimal alignments (with the same
score) or just the optimal score.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_make_score_matrix_generic"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_make_score_matrix_generic</span>(<span class="sig-arg">sequenceA</span>,
        <span class="sig-arg">sequenceB</span>,
        <span class="sig-arg">match_fn</span>,
        <span class="sig-arg">gap_A_fn</span>,
        <span class="sig-arg">gap_B_fn</span>,
        <span class="sig-arg">penalize_end_gaps</span>,
        <span class="sig-arg">align_globally</span>,
        <span class="sig-arg">score_only</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="Bio.pairwise2-pysrc.html#_make_score_matrix_generic">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Generate a score and traceback matrix (PRIVATE).</p>
<p>This implementation according to Needleman-Wunsch allows the usage of
general gap functions and is rather slow. It is automatically called if
you define your own gap functions. You can force the usage of this method
with <tt class="rst-docutils literal">force_generic=True</tt>.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_recover_alignments"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_recover_alignments</span>(<span class="sig-arg">sequenceA</span>,
        <span class="sig-arg">sequenceB</span>,
        <span class="sig-arg">starts</span>,
        <span class="sig-arg">best_score</span>,
        <span class="sig-arg">score_matrix</span>,
        <span class="sig-arg">trace_matrix</span>,
        <span class="sig-arg">align_globally</span>,
        <span class="sig-arg">gap_char</span>,
        <span class="sig-arg">one_alignment_only</span>,
        <span class="sig-arg">gap_A_fn</span>,
        <span class="sig-arg">gap_B_fn</span>,
        <span class="sig-arg">reverse</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="Bio.pairwise2-pysrc.html#_recover_alignments">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Do the backtracing and return a list of alignments (PRIVATE).</p>
<p>Recover the alignments by following the traceback matrix.  This
is a recursive procedure, but it's implemented here iteratively
with a stack.</p>
<p>sequenceA and sequenceB may be sequences, including strings,
lists, or list-like objects.  In order to preserve the type of
the object, we need to use slices on the sequences instead of
indexes.  For example, sequenceA[row] may return a type that's
not compatible with sequenceA, e.g. if sequenceA is a list and
sequenceA[row] is a string.  Thus, avoid using indexes and use
slices, e.g. sequenceA[row:row+1].  Assume that client-defined
sequence classes preserve these semantics.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_find_start"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_find_start</span>(<span class="sig-arg">score_matrix</span>,
        <span class="sig-arg">best_score</span>,
        <span class="sig-arg">align_globally</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="Bio.pairwise2-pysrc.html#_find_start">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Return a list of starting points (score, (row, col)) (PRIVATE).</p>
<p>Indicating every possible place to start the tracebacks.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_clean_alignments"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_clean_alignments</span>(<span class="sig-arg">alignments</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="Bio.pairwise2-pysrc.html#_clean_alignments">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Take a list of alignments and return a cleaned version (PRIVATE).</p>
<p>Remove duplicates, make sure begin and end are set correctly, remove
empty alignments.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="format_alignment"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">format_alignment</span>(<span class="sig-arg">align1</span>,
        <span class="sig-arg">align2</span>,
        <span class="sig-arg">score</span>,
        <span class="sig-arg">begin</span>,
        <span class="sig-arg">end</span>,
        <span class="sig-arg">full_sequences</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="Bio.pairwise2-pysrc.html#format_alignment">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Format the alignment prettily into a string.</p>
<p>IMPORTANT: Gap symbol must be &quot;-&quot; (or ['-'] for lists)!</p>
<p>Since Biopython 1.71 identical matches are shown with a pipe
character, mismatches as a dot, and gaps as a space.</p>
<p>Prior releases just used the pipe character to indicate the
aligned region (matches, mismatches and gaps).</p>
<p>Also, in local alignments, if the alignment does not include
the whole sequences, now only the aligned part is shown,
together with the start positions of the aligned subsequences.
The start positions are 1-based; so start position n is the
n-th base/amino acid in the <em>un-aligned</em> sequence.</p>
<p>NOTE: This is different to the alignment's begin/end values,
which give the Python indices (0-based) of the bases/amino acids
in the <em>aligned</em> sequences.</p>
<p>If you want to restore the 'historic' behaviour, that means
displaying the whole sequences (including the non-aligned parts),
use <tt class="rst-docutils literal">full_sequences=True</tt>. In this case, the non-aligned leading
and trailing parts are also indicated by spaces in the match-line.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_python_make_score_matrix_fast"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_python_make_score_matrix_fast</span>(<span class="sig-arg">sequenceA</span>,
        <span class="sig-arg">sequenceB</span>,
        <span class="sig-arg">match_fn</span>,
        <span class="sig-arg">open_A</span>,
        <span class="sig-arg">extend_A</span>,
        <span class="sig-arg">open_B</span>,
        <span class="sig-arg">extend_B</span>,
        <span class="sig-arg">penalize_extend_when_opening</span>,
        <span class="sig-arg">penalize_end_gaps</span>,
        <span class="sig-arg">align_globally</span>,
        <span class="sig-arg">score_only</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="Bio.pairwise2-pysrc.html#_python_make_score_matrix_fast">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Generate a score and traceback matrix according to Gotoh (PRIVATE).</p>
<p>This is an implementation of the Needleman-Wunsch dynamic programming
algorithm as modified by Gotoh, implementing affine gap penalties.
In short, we have three matrices, holding scores for alignments ending
in (1) a match/mismatch, (2) a gap in sequence A, and (3) a gap in
sequence B, respectively. However, we can combine them in one matrix,
which holds the best scores, and store only those values from the
other matrices that are actually used for the next step of calculation.
The traceback matrix holds the positions for backtracing the alignment.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://biopython.org">Biopython</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Wed Nov  6 13:32:24 2019
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
